---

- name: 0|add_pull
  ansible.builtin.include_tasks: 0.add_pull.yaml
  loop: "{{ chr_vpn_pools }}"
  tags: add_address_pool

- name: Add vpn profile
  community.routeros.command:
    commands: >-
      /ppp profile add name=vpn-profile local-address={{ chr_vpn_pools.0.local_address }}
      remote-address={{ chr_vpn_pools.0.name }} use-encryption=yes only-one=yes
  tags: add_profile

- name: 1|configure_ppp_secrets
  ansible.builtin.include_tasks: 1.configure_ppp_secrets.yaml
  loop: "{{ ppp_user_accounts }}"
  tags: configure_ppp_secrets
